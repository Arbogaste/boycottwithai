---
import Base from '../../layouts/Base.astro';
import internalFeed from '../../data/internal_feed.json';
import { getLangFromUrl, useTranslations } from '../../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

export async function get() {
  return { props: { items: internalFeed } };
}
---

<head>
  <title>{t('manifesto.title')} — BoycottWithAI</title>
  <meta name="description" content={t('manifesto.subtitle')} />
</head>

<Base>
  <section>
    <h1>{t('manifesto.title')}</h1>
    <p class="muted">{t('manifesto.subtitle')}</p>
    <div class="card" style="margin-top:12px">
      <h3>Contesto attuale: 2024–2025</h3>
      <ul>
        <li><strong>Fallimento climatico:</strong> COP28 si è chiusa senza impegni vincolanti, con sussidi record ai combustibili fossili. Le emissioni globali di CO₂ hanno raggiunto un nuovo massimo (IEA), mentre eventi estremi hanno sfollato oltre 40 milioni di persone (IDMC).</li>
        <li><strong>Medio Oriente & genocidio:</strong> Oltre 30.000 civili uccisi a Gaza (OCHA, 2024), con l'ONU che denuncia carestia e distruzione sistematica di infrastrutture. Sudan e Yemen ignorati, con milioni di sfollati e cessate il fuoco violate.</li>
        <li><strong>Istituzioni assenti:</strong> Il Consiglio di Sicurezza ONU bloccato dai veti; UE e G7 aumentano spese militari e export di armi, ignorando appelli per cessate il fuoco e corridoi umanitari.</li>
        <li><strong>Riarmaento globale:</strong> La spesa militare mondiale ha superato i 2,4 trilioni di dollari (SIPRI, 2024), mentre le risoluzioni di pace restano ferme e la protezione dei civili è marginale.</li>
      </ul>
      <p class="muted">Le nostre istituzioni stanno fallendo nell'affrontare le cause profonde di violenza, crisi climatica e migrazioni forzate. Questo progetto nasce per denunciare questi fallimenti e promuovere azione civica diretta.</p>
    </div>
    <div class="card" style="margin-top:12px">
      <h3>{t('manifesto.vision.title')}</h3>
      <p class="muted">{t('manifesto.vision.p1')}</p>
    </div>

    <article class="card" style="margin-top:18px">
      <h2>{t('manifesto.methods.title')}</h2>
      <ul>
        {t('manifesto.methods.list').map(item => (
          <li>{item}</li>
        ))}
      </ul>
    </article>

    <article class="card" style="margin-top:12px">
      <h2>{t('manifesto.antiwar.title')}</h2>
      <p>{t('manifesto.antiwar.p1')}</p>
      <ul>
        <li>{t('manifesto.antiwar.policies')}</li>
        <li>{t('manifesto.antiwar.divest')}</li>
        <li>{t('manifesto.antiwar.education')}</li>
      </ul>
    </article>

    <article class="card" style="margin-top:12px">
      <h2>{t('manifesto.failures.title')}</h2>
      <ul>
        <li>{t('manifesto.failures.environment')}</li>
        <li>{t('manifesto.failures.energy')}</li>
        <li>{t('manifesto.failures.investment')}</li>
        <li>{t('manifesto.failures.health')}</li>
        <li>{t('manifesto.failures.ai')}</li>
      </ul>
    </article>

    <article class="card" style="margin-top:12px">
      <h2>{t('manifesto.values.title')}</h2>
      <ul>
        {t('manifesto.values.list').map(item => (
          <li>{item}</li>
        ))}
      </ul>
    </article>

    <!-- FEEDS SECTION -->
    <h2 style="margin-top:32px">{t('feeds.title')}</h2>
    <p class="muted">{t('feeds.subtitle')}</p>

    <div style="margin:16px 0">
      <a class="button" href="/combined-rss.xml">Iscriviti al feed unificato</a>
    </div>

    <div class="grid">
      {Astro.props.items && Astro.props.items.length ? (
        (Astro.props.items as any[]).slice(0, 30).map(item => (
          <div class="card">
            <a href={item.link}><h4>{item.title}</h4></a>
            <p class="muted">{item.pubDate}</p>
            <p class="muted">{item.contentSnippet || item.content || item.description}</p>
          </div>
        ))
      ) : (
        <div class="card">Nessun elemento disponibile al momento.</div>
      )}
    </div>

  </section>
</Base>
